<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>私の猫ちゃんたち</title>
    <style>
      img {
        display: block; /* 画像をブロック要素として扱う */
        margin-bottom: 15px; /* 各画像の下に15ピクセルの間隔を空ける */
        max-width: 400px; /* 画像が大きくなりすぎないように最大幅を指定 */
        border-radius: 8px; /* 画像の角を少し丸くする */
        box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* 画像に影をつけて立体感を出す */
      }
      /* Q&Aセクションの見た目を少し整える */
      #qa-section {
        margin-top: 40px;
        padding: 20px;
        border-top: 2px solid #eee;
      }
    </style>
</head>
<body>

    <h1>こんにちは、私の可愛い猫ちゃんたち！</h1>
    <p>ブラウザだけでウェブサイトを作ることができました。</p>
    
    <!-- ▼▼▼ 猫の画像 ▼▼▼ -->
    <img src="images/pino.jpg" alt="猫のぴの">
    <img src="images/teto.jpg" alt="猫のてと">
    <img src="images/ruka.jpg" alt="猫のるか">
    <img src="images/abi.jpg" alt="猫のあび">
    <!-- ▲▲▲ ここまで ▲▲▲ -->


    <!-- Q&Aセクション -->
    <div id="qa-section">
        <h2>AIに質問してみよう！</h2>
        <p>「ぴのの名前は？」や「てとは何してる？」のように質問してね。</p>

        <input type="text" id="question-input" placeholder="ここに質問を入力...">
        <button id="ask-button">質問する</button>

        <h3>答え：</h3>
        <p id="answer-area">ここに答えが表示されます</p>
    </div>

    <!-- ▼▼▼ ここが修正点です！JavaScriptのコードを<script>タグで囲みます ▼▼▼ -->
    <script>
      // HTMLの部品を取得
      const questionInput = document.getElementById('question-input');
      const askButton = document.getElementById('ask-button');
      const answerArea = document.getElementById('answer-area');

      // 「質問する」ボタンがクリックされた時の処理
      askButton.addEventListener('click', async function() {
        const userQuestion = questionInput.value;
        if (!userQuestion) {
          answerArea.textContent = '質問を入力してください。';
          return;
        }

        // 答えの表示を「考え中...」に更新
        answerArea.textContent = 'AIが考えています...';
        askButton.disabled = true; // ボタンを一時的に無効化

        try {
          // 私たちのサーバー(/ask)に質問を送信する
          const response = await fetch('/ask', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ question: userQuestion }),
          });

          // サーバーからの返事を待つ
          const data = await response.json();

          if (response.ok) {
            // 成功したら答えを表示
            answerArea.textContent = data.answer;
          } else {
            // エラーだったらエラーメッセージを表示
            answerArea.textContent = 'エラーが発生しました: ' + data.error;
          }

        } catch (error) {
          console.error('通信エラー:', error);
          answerArea.textContent = 'サーバーとの通信に失敗しました。';
        } finally {
          askButton.disabled = false; // ボタンを再度有効化
        }
      });
    </script>
    <!-- ▲▲▲ ここまで ▲▲▲ -->

</body>
</html>